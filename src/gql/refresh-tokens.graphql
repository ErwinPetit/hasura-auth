mutation insertHashedRefreshToken(
  $hashedRefreshToken: authHashedRefreshTokens_insert_input!
) {
  insertAuthHashedRefreshToken(object: $hashedRefreshToken) {
    hashedRefreshToken
  }
}

mutation deleteRefreshTokens($refreshToken: uuid, $hashedRefreshToken: String) {
  deleteAuthRefreshTokens(where: { refreshToken: { _eq: $refreshToken } }) {
    affected_rows
  }
  deleteAuthHashedRefreshTokens(
    where: { hashedRefreshToken: { _eq: $hashedRefreshToken } }
  ) {
    affected_rows
  }
}

mutation deleteUserRefreshTokens($userId: uuid!) {
  deleteAuthRefreshTokens(where: { user: { id: { _eq: $userId } } }) {
    affected_rows
  }
}

mutation deleteExpiredRefreshTokens {
  deleteAuthRefreshTokens(where: { expiresAt: { _lt: now } }) {
    affected_rows
  }
}
